var _analytics=function(e){"use strict";function t(e,t){var n,r=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)),r}function n(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?t(Object(r),!0).forEach(function(t){var n,i;n=e,i=r[t],t in n?Object.defineProperty(n,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[t]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function r(e,t,n,r,i){for(t=t.split?t.split("."):t,r=0;r<t.length;r++)e=e?e[t[r]]:i;return e===i?n:e}var i="undefined",a="object",o="undefined"!=typeof process?process:{},u=(o.env&&o.env.NODE_ENV,"undefined"!=typeof window);function c(e,t){return t.charAt(0)[e]()+t.slice(1)}null!=o.versions&&o.versions.node,u&&"nodejs"===window.name||"undefined"!=typeof navigator&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom"));var s=c.bind(null,"toUpperCase"),l=c.bind(null,"toLowerCase");function f(e,t){var n,r;return void 0===t&&(t=!0),e=h(n=e)?s("null"):"object"==typeof n?p((r=n).constructor)?r.constructor.name:null:Object.prototype.toString.call(n).slice(8,-1),t?l(e):e}function d(e,t){return typeof t===e}var p=d.bind(null,"function"),g=d.bind(null,"string"),m=d.bind(null,"undefined"),y=d.bind(null,"boolean");function h(e){return null===e}function v(e){if((t=e)&&("object"==typeof t||null!==t)){for(var t,n=e;null!==Object.getPrototypeOf(n);)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(e)===n}}function b(e,t){if("object"!=typeof t||h(t))return!1;if(t instanceof e)return!0;var n,r=f(new e(""));if((n=t)instanceof Error||g(n.message)&&n.constructor&&"number"===f(n=n.constructor.stackTraceLimit)&&!isNaN(n))for(;t;){if(f(t)===r)return!0;t=Object.getPrototypeOf(t)}return!1}function I(e,t){var n=e instanceof Element||e instanceof HTMLDocument;return n&&t?(void 0===t&&(t=""),e&&e.nodeName===t.toUpperCase()):n}function $(){return[].slice.call(arguments,1),1}function S(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(t){return null}}function x(){for(var e="",t=0,n=4294967295*Math.random()|0;t++<36;){var r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx"[t-1],i=15&n;e+="-"==r||"4"==r?r:("x"==r?i:3&i|8).toString(16),n=t%8==0?4294967295*Math.random()|0:n>>4}return e}d.bind(null,"symbol"),b.bind(null,TypeError),b.bind(null,SyntaxError),$(I,"form"),$(I,"button"),$(I,"input"),$(I,"select");var w="global",E="__global__",_=typeof self==a&&self.self===self&&self||typeof global==a&&global.global===global&&global||void 0;function k(e){return _[E][e]}function N(e,t){return _[E][e]=t}function P(e){delete _[E][e]}function A(e,t,n){var r,i;try{O(e)&&(i=(r=window[e])[t].bind(r))}catch(a){}return i||n}_[E]||(_[E]={});var T={};function O(e){if(typeof T[e]!=i)return T[e];try{var t=window[e];t.setItem(i,i),t.removeItem(i)}catch(n){return T[e]=!1}return T[e]=!0}function z(){return(z=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var j="function",M="undefined",C="@@redux/"+Math.random().toString(36),q=typeof Symbol===j&&Symbol.observable||"@@observable",U=" != "+j;function D(){var e=[].slice.call(arguments);return 0===e.length?function(e){return e}:1===e.length?e[0]:e.reduce(function(e,t){return function(){return e(t.apply(void 0,[].slice.call(arguments)))}})}var V="__anon_id",L="__user_id",R="__user_traits",o={__proto__:null,ANON_ID:V,USER_ID:L,USER_TRAITS:R},X="userId",B="anonymousId",H=["bootstrap","params","campaign","initializeStart","initialize","initializeEnd","ready","resetStart","reset","resetEnd","pageStart","page","pageEnd","pageAborted","trackStart","track","trackEnd","trackAborted","identifyStart","identify","identifyEnd","identifyAborted","userIdChanged","registerPlugins","enablePlugin","disablePlugin","online","offline","setItemStart","setItem","setItemEnd","setItemAborted","removeItemStart","removeItem","removeItemEnd","removeItemAborted"],W=["name","EVENTS","config","loaded"],F=H.reduce(function(e,t){return e[t]=t,e},{registerPluginType:function(e){return"registerPlugin:"+e},pluginReadyType:function(e){return"ready:"+e}}),G=/^utm_/,J=/^an_prop_/,K=/^an_trait_/;function Q(e){return{userId:e.getItem(L),anonymousId:e.getItem(V),traits:e.getItem(R)}}var Y=function(e){return"__TEMP__"+e},Z={};function ee(e,t){Z[e]&&p(Z[e])&&(Z[e](t),delete Z[e])}function et(e){var t,n,r=e.data,i=e.action,a=e.instance,o=e.state,u=e.allPlugins,c=e.allMatches,s=e.store,l=e.EVENTS;try{var f=o.plugins,d=o.context,g=i.type,m=g.match(en),y=r.exact.map(function(e){return e.pluginName}),h=(m&&(y=c.during.map(function(e){return e.pluginName})),t=a,n=y,function(e,r,i){var a,o,u,c,s,l,f,d,p=r.config,r=r.name,g=r+"."+e.type,r=(i&&(g=i.event),e.type.match(en)?(u=r,c=g,s=n,l=i,f=e,function(e,t){var n=l?l.name:u,r=t&&ef(t)?t:s;if(l&&(!(r=t&&ef(t)?t:[u]).includes(u)||1!==r.length))throw Error("Method "+c+" can only abort "+u+" plugin. "+JSON.stringify(r)+" input valid");return z({},f,{abort:{reason:e,plugins:r,caller:c,_:n}})}):(a=e,o=g,function(){throw Error(a.type+" action not cancellable. Remove abort in "+o)}));return{payload:(d=e,Object.keys(d).reduce(function(e,t){return"type"===t||(e[t]=v(d[t])?Object.assign({},d[t]):d[t]),e},{})),instance:t,config:p||{},abort:r}}),b=r.exact.reduce(function(e,t){var n=t.pluginName,t=t.methodName,r=!1;return t.match(/^initialize/)||t.match(/^reset/)||(r=!f[n].loaded),d.offline&&t.match(/^(page|track|identify)/)&&(r=!0),e[""+n]=r,e},{});return Promise.resolve(r.exact.reduce(function(e,t,n){var o=t.pluginName;return Promise.resolve(e).then(function(e){function t(){return Promise.resolve(e)}var n=r.namespaced&&r.namespaced[o]?Promise.resolve(r.namespaced[o].reduce(function(e,t,n){return Promise.resolve(e).then(function(e){var n,r,i;if(t.method&&p(t.method)){var c,s=t.methodName,l=t.pluginName,d=ep(s);if(d&&d.name===l)throw c=ep(d.method),Error([l+" plugin is calling method "+s,"Plugins cant call self","Use "+d.method+" "+(c?"or "+c.method:"")+" in "+l+" plugin insteadof "+s].join("\n"));return Promise.resolve(t.method({payload:e,instance:a,abort:(n=e,r=o,i=t.pluginName,function(e,t){return z({},n,{abort:{reason:e,plugins:t||[r],caller:g,from:i||r}})}),config:eo(t.pluginName,f,u),plugins:f})).then(function(t){return t=v(t)?t:{},Promise.resolve(z({},e,t))})}return e})},Promise.resolve(i))).then(function(t){e[o]=t}):void(e[o]=i);return n&&n.then?n.then(t):t()})},Promise.resolve({}))).then(function(e){return Promise.resolve(r.exact.reduce(function(t,n,i){try{var o=r.exact.length===i+1,c=n.pluginName,l=u[c];return Promise.resolve(t).then(function(t){var n=e[c]||{};if(es(n=m?t:n,c))return ea({data:n,method:g,instance:a,pluginName:c,store:s}),Promise.resolve(t);if(es(t,c))return o&&ea({data:t,method:g,instance:a,store:s}),Promise.resolve(t);if(b.hasOwnProperty(c)&&!0===b[c])return s.dispatch({type:"queue",plugin:c,payload:n,_:{called:"queue",from:"queueMechanism"}}),Promise.resolve(t);var r=h(e[c],u[c]);return Promise.resolve(l[g]({abort:r.abort,payload:n,instance:a,config:eo(c,f,u),plugins:f})).then(function(r){var r=v(r)?r:{},r=z({},t,r),i=e[c];return es(i,c)?ea({data:i,method:g,instance:a,pluginName:c,store:s}):!(((i=g+":"+c).match(/:/g)||[]).length<2)||g.match(er)||g.match(ei)||a.dispatch(z({},m?r:n,{type:i,_:{called:i,from:"submethod"}})),Promise.resolve(r)})})}catch(d){return Promise.reject(d)}},Promise.resolve(i))).then(function(e){if(!(g.match(en)||g.match(/^registerPlugin/)||g.match(ei)||g.match(er)||g.match(/^params/)||g.match(/^userIdChanged/))){if(l.plugins.includes(g),e._&&e._.originalAction===g)return e;var t=z({},e,{_:{originalAction:e.type,called:e.type,from:"engineEnd"}});el(e,r.exact.length)&&!g.match(/End$/)&&(t=z({},t,{type:e.type+"Aborted"})),s.dispatch(t)}return e})})}catch(I){return Promise.reject(I)}}var en=/Start$/,er=/^bootstrap/,ei=/^ready/;function ea(e){var t=e.pluginName,t=e.method+"Aborted"+(t?":"+t:"");e.store.dispatch(z({},e.data,{type:t,_:{called:t,from:"abort"}}))}function eo(e,t,n){return(t=t[e]||n[e])&&t.config?t.config:{}}function eu(e,t){return t.reduce(function(t,n){return n[e]?t.concat({methodName:e,pluginName:n.name,method:n[e]}):t},[])}function ec(e,t){var n=e.replace(en,""),t=t?":"+t:"";return[e+t,n+t,n+"End"+t]}function es(e,t){return(e=e.abort)&&(!0===e||ed(e,t)||e&&ed(e.plugins,t))}function el(e,t){if(e=e.abort){if(!0===e||g(e))return 1;var n=e.plugins;return ef(e)&&e.length===t||ef(n)&&n.length===t}}function ef(e){return Array.isArray(e)}function ed(e,t){return!(!e||!ef(e))&&e.includes(t)}function ep(e){return!!(e=e.match(/(.*):(.*)/))&&{method:e[1],name:e[2]}}var eg=function(){var e=this;this.before=[],this.after=[],this.addMiddleware=function(t,n){e[n]=e[n].concat(t)},this.removeMiddleware=function(t,n){var r=e[n].findIndex(function(e){return e===t});-1!==r&&(e[n]=[].concat(e[n].slice(0,r),e[n].slice(r+1)))},this.dynamicMiddlewares=function(t){return function(n){return function(r){return function(i){var a={getState:n.getState,dispatch:function(e){return n.dispatch(e)}},o=e[t].map(function(e){return e(a)});return D.apply(void 0,o)(r)(i)}}}}};function em(e,t){return e.substring(t.length+1,e.length)}function ey(e,t,n){return e.reduce(function(e,r){return e[r]=z({},n[r],{enabled:t}),e},n)}function eh(e){try{return JSON.parse(JSON.stringify(e))}catch(t){}return e}var ev={last:{},history:[]};function eb(e,t){void 0===e&&(e=ev);var n=t.options,r=t.meta;return t.type===F.track?(t=eh(z({event:t.event,properties:t.properties},Object.keys(n).length&&{options:n},{meta:r})),z({},e,{last:t,history:e.history.concat(t)})):e}var eI={actions:[]};function e$(e,t){void 0===e&&(e=eI);var n=t.payload;switch(t.type){case"queue":var r=n&&n.type&&n.type===F.identify?[t].concat(e.actions):e.actions.concat(t);return z({},e,{actions:r});case"dequeue":return[];default:return e}}var eS=/#.*$/,ex=function(e){if(void 0===e&&(e={}),!u)return e;var t,n=document,r=n.title,n=n.referrer,i=window,a=i.location,o=i.innerWidth,i=i.innerHeight,c=a.hash,a=a.search,s=(t=a,(s=function(){if(u){for(var e,t=document.getElementsByTagName("link"),n=0;e=t[n];n++)if("canonical"===e.getAttribute("rel"))return e.getAttribute("href")}}())?s.match(/\?/)?s:s+t:window.location.href.replace(eS,"")),r={title:r,url:s,path:"/"+((t=/(http[s]?:\/\/)?([^\/\s]+\/)(.*)/g.exec(t=s))&&t[3]?t[3].split("?")[0].replace(eS,""):""),hash:c,search:a,width:o,height:i};return n&&""!==n&&(r.referrer=n),z({},r,e)},ew={last:{},history:[]};function e8(e,t){void 0===e&&(e=ew);var n=t.options;return t.type===F.page?(t=eh(z({properties:t.properties,meta:t.meta},Object.keys(n).length&&{options:n})),z({},e,{last:t,history:e.history.concat(t)})):e}var a={},eE={initialized:!1,sessionId:x(),app:null,version:null,debug:!1,offline:!!u&&!navigator.onLine,os:{name:"na"},userAgent:u?navigator.userAgent:"node",library:{name:"analytics",version:"0.11.0"},timezone:void 0,locale:void 0,campaign:{},referrer:a};function e_(e,t){var n=(e=void 0===e?eE:e).initialized,r=t.campaign;switch(t.type){case F.campaign:return z({},e,{campaign:r});case F.offline:return z({},e,{offline:!0});case F.online:return z({},e,{offline:!1});default:return n?e:z({},eE,e,{initialized:!0})}}var ek=["plugins","reducers","storage"];function eN(){return N("analytics",[]),function(e){return function(t,n,r){var t=e(t,n,r),i=t.dispatch;return Object.assign(t,{dispatch:function(e){return _[E].analytics.push(e.action||e),i(e)}})}}}function eP(){return function(){return D(D.apply(null,arguments),eN())}}function eA(e){return e?"array"===f(e)?e:[e]:[]}function eT(e,t,n){void 0===e&&(e={});var r,i,a=x();return t&&(Z[a]=(r=t,i=function(e){for(var t,n=e||Array.prototype.slice.call(arguments),r=0;r<n.length;r++)if(p(n[r])){t=n[r];break}return t}(n),function(e){i&&i(e),r(e)})),z({},e,{rid:a,ts:(new Date).getTime()},t?{hasCallback:!0}:{})}var eO="before",ez="after",ej="cookie",eM=eU(),eC=eD,e0=eD;function eq(e){return eM?eD(e,"",-1):P(e)}function eU(){if(void 0!==eM)return eM;var e="cookiecookie";try{eD(e,e),eM=-1!==document.cookie.indexOf(e),eq(e)}catch(t){eM=!1}return eM}function eD(e,t,n,r,i,a){var o;if("undefined"!=typeof window)return o=1<arguments.length,!1===eM&&(o?N(e,t):k(e)),o?document.cookie=e+"="+encodeURIComponent(t)+(n?"; expires="+new Date(+new Date+1e3*n).toUTCString()+(r?"; path="+r:"")+(i?"; domain="+i:"")+(a?"; secure":""):""):decodeURIComponent((("; "+document.cookie).split("; "+e+"=")[1]||"").split(";")[0])}var eV="localStorage",a=O.bind(null,"localStorage"),eL=(A("localStorage","getItem",k),A("localStorage","setItem",N),A("localStorage","removeItem",P),"sessionStorage"),eR=O.bind(null,"sessionStorage");function e2(e){var t=e;try{if("true"===(t=JSON.parse(e)))return!0;if("false"===t)return!1;if(v(t))return t;parseFloat(t)===t&&(t=parseFloat(t))}catch(n){}if(null!==t&&""!==t)return t}A("sessionStorage","getItem",k),A("sessionStorage","setItem",N),A("sessionStorage","removeItem",P);var e9=a(),e1=eR(),e7=eU();function e4(e,t){if(e){var t=e3(t),n=!eB(t),r=e6(t)?e2(localStorage.getItem(e)):void 0;if(n&&!m(r))return r;var i=eX(t)?e2(eC(e)):void 0;return n&&i?i:(t=e5(t)?e2(sessionStorage.getItem(e)):void 0,n&&t)?t:(e=k(e),n?e:{localStorage:r,sessionStorage:t,cookie:i,global:e})}}function e3(e){return e?g(e)?e:e.storage:"any"}function e6(e){return e9&&eH(e,eV)}function eX(e){return e7&&eH(e,ej)}function e5(e){return e1&&eH(e,eL)}function eB(e){return"*"===e||"all"===e}function eH(e,t){return"any"===e||e===t||eB(e)}function eW(e,t,n){return{location:e,current:t,previous:n}}var eF={setItem:function(e,t,n){var r,i,a;if(e&&!m(t))return r={},n=e3(n),i=JSON.stringify(t),a=!eB(n),e6(n)&&(r[eV]=eW(eV,t,e2(localStorage.getItem(e))),localStorage.setItem(e,i),a)?r[eV]:eX(n)&&(r[ej]=eW(ej,t,e2(eC(e))),e0(e,i),a)?r[ej]:e5(n)&&(r[eL]=eW(eL,t,e2(sessionStorage.getItem(e))),sessionStorage.setItem(e,i),a)?r[eL]:(r[w]=eW(w,t,k(e)),N(e,t),a?r[w]:r)},getItem:e4,removeItem:function(e,t){var n,r;if(e)return t=e3(t),n=e4(e,"*"),r={},!m(n.localStorage)&&e6(t)&&(localStorage.removeItem(e),r[eV]=n.localStorage),!m(n.cookie)&&eX(t)&&(eq(e),r[ej]=n.cookie),!m(n.sessionStorage)&&e5(t)&&(sessionStorage.removeItem(e),r[eL]=n.sessionStorage),!m(n.global)&&eH(t,w)&&(P(e),r[w]=n.global),r}};function eG(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return function e(t){function n(){return Z}function i(){throw Error("Abort disabled inListener")}var a,o,c,s,l,f,d,m,h,b,I,$,w,E=(t=void 0===t?{}:t).reducers||{},_=t.initialUser||{},A=(t.plugins||[]).reduce(function(e,t){if(p(t))return e.middlewares=e.middlewares.concat(t),e;if(t.NAMESPACE&&(t.name=t.NAMESPACE),!t.name)throw Error("https://lytics.dev/errors/1");var n=t.EVENTS?Object.keys(t.EVENTS).map(function(e){return t.EVENTS[e]}):[],n=(e.pluginEnabled[t.name]=!(!1===t.enabled||t.config&&!1===t.config.enabled),delete t.enabled,t.methods&&(e.methods[t.name]=Object.keys(t.methods).reduce(function(e,n){var r;return e[n]=(r=t.methods[n],function(){for(var e=Array.prototype.slice.call(arguments),t=Array(r.length),n=0;n<e.length;n++)t[n]=e[n];return t[t.length]=ev,r.apply({instance:ev},t)}),e},{}),delete t.methods),Object.keys(t).concat(n)),n=new Set(e.events.concat(n));if(e.events=Array.from(n),e.pluginsArray=e.pluginsArray.concat(t),e.plugins[t.name])throw Error(t.name+"AlreadyLoaded");return e.plugins[t.name]=t,e.plugins[t.name].loaded||(e.plugins[t.name].loaded=function(){return!0}),e},{plugins:{},pluginEnabled:{},methods:{},pluginsArray:[],middlewares:[],events:[]}),T=t.storage||{getItem:k,setItem:N,removeItem:P},O=(l=T,function(e,t,n){return t.getState("user")[e]||(n&&v(n)&&n[e]?n[e]:Q(l)[e]||k(Y(e))||null)}),Z=A.plugins,er=A.events.filter(function(e){return!W.includes(e)}).sort(),ei=new Set(er.concat(H).filter(function(e){return!W.includes(e)})),ei=Array.from(ei).sort(),ea=new eg,eo=ea.addMiddleware,es=ea.removeMiddleware,ea=ea.dynamicMiddlewares,ef=function(e){for(var t,n=e?(e=e.match(/\?(.*)/))&&e[1]?e[1].split("#")[0]:"":u&&window.location.search.substring(1),r=Object.create(null),i=/([^&=]+)=?([^&]*)/g;o=i.exec(n);){var a=S(o[1]),o=S(o[2]);"[]"===a.substring(a.length-2)?(r[a=a.substring(0,a.length-2)]||(r[a]=[])).push(o):r[a]=""===o||o}for(t in r){var c=t.split("[");if(1<c.length){s=void 0,l=void 0,f=void 0,d=void 0,p=void 0,g=void 0;for(var s=r,l=c.map(function(e){return e.replace(/[?[\]\\ ]/g,"")}),f=r[t],d=l.length-1,p=0;p<d;++p){var g=l[p];if("__proto__"===g||"constructor"===g)break;g in s||(s[g]={}),s=s[g]}s[l[d]]=f,delete r[t]}}return r}(),ed=Q(T),ep=z({},ed,_,ef.an_uid?{userId:ef.an_uid}:{},ef.an_aid?{anonymousId:ef.an_aid}:{}),eh=(ep.anonymousId||(ep.anonymousId=x()),z({enable:function(e,t){return new Promise(function(n){ew.dispatch({type:F.enablePlugin,plugins:eA(e),_:{originalAction:F.enablePlugin}},n,[t])})},disable:function(e,t){return new Promise(function(n){ew.dispatch({type:F.disablePlugin,plugins:eA(e),_:{originalAction:F.disablePlugin}},n,[t])})}},A.methods)),ev={identify:function(e,t,n,r){try{var i=g(e)?e:null,a=v(e)?e:t,o=n||{},u=ev.user(),c=(N(Y(X),i),i||a.userId||O(X,ev,a));return Promise.resolve(new Promise(function(e){ew.dispatch(z({type:F.identifyStart,userId:c,traits:a||{},options:o,anonymousId:u.anonymousId},u.id&&u.id!==i&&{previousId:u.id}),e,[t,n,r])}))}catch(s){return Promise.reject(s)}},track:function(e,t,n,r){try{var i=v(e)?e.event:e;if(!i||!g(i))throw Error("EventMissing");var a=v(e)?e:t||{},o=v(n)?n:{};return Promise.resolve(new Promise(function(e){ew.dispatch({type:F.trackStart,event:i,properties:a,options:o,userId:O(X,ev,t),anonymousId:O(B,ev,t)},e,[t,n,r])}))}catch(u){return Promise.reject(u)}},page:function(e,t,n){try{var r=v(e)?e:{},i=v(t)?t:{};return Promise.resolve(new Promise(function(a){ew.dispatch({type:F.pageStart,properties:ex(r),options:i,userId:O(X,ev,r),anonymousId:O(B,ev,r)},a,[e,t,n])}))}catch(a){return Promise.reject(a)}},user:function(e){if(e===X||"id"===e)return O(X,ev);if(e===B||"anonId"===e)return O(B,ev);var t=ev.getState("user");return e?r(t,e):t},reset:function(e){return new Promise(function(t){ew.dispatch({type:F.resetStart},t,e)})},ready:function(e){return ev.on(F.ready,e)},on:function(e,t){if(!e||!p(t))return!1;if(e===F.bootstrap)throw Error(".on disabled for "+e);var n,r,a=/Start$|Start:/;if("*"===e)return r=function(e){return function(e){return function(n){return n.type.match(a)||t({payload:n,instance:ev,plugins:Z}),e(n)}}},eo(n=function(e){return function(e){return function(n){return n.type.match(a)&&t({payload:n,instance:ev,plugins:Z}),e(n)}}},eO),eo(r,ez),function(){es(n,eO),es(r,ez)};function o(n){return function(n){return function(r){return r.type===e&&t({payload:r,instance:ev,plugins:Z,abort:i}),n(r)}}}var u=e.match(a)?eO:ez;return eo(o,u),function(){return es(o,u)}},once:function(e,t){if(!e||!p(t))return!1;if(e===F.bootstrap)throw Error(".once disabled for "+e);var n=ev.on(e,function(e){t({payload:e.payload,instance:ev,plugins:Z,abort:i}),n()});return n},getState:function(e){var t=ew.getState();return e?r(t,e):Object.assign({},t)},dispatch:function(e){var t=g(e)?{type:e}:e;if(H.includes(t.type))throw Error("reserved action "+t.type);t=z({},t,{_:z({originalAction:t.type},e._||{})}),ew.dispatch(t)},enablePlugin:eh.enable,disablePlugin:eh.disable,plugins:eh,storage:{getItem:T.getItem,setItem:function(e,t,n){ew.dispatch({type:F.setItemStart,key:e,value:t,options:n})},removeItem:function(e,t){ew.dispatch({type:F.removeItemStart,key:e,options:t})}},setAnonymousId:function(e,t){ev.storage.setItem(V,e,t)},events:{core:H,plugins:er}},ei=A.middlewares.concat([function(e){return function(e){return function(t){return t.meta||(t.meta=eT()),e(t)}}},ea(eO),(a=ev,o=n,c={all:ei,plugins:er},s={},function(e){return function(t){return function(n){try{var r,i,u,l,f,d,g,m,h=function(e){return r?e:t(I)},v=n.type,b=n.plugins,I=n;if(n.abort)return Promise.resolve(t(n));v===F.enablePlugin&&e.dispatch({type:F.initializeStart,plugins:b,disabled:[],fromEnable:!0,meta:n.meta}),v===F.disablePlugin&&setTimeout(function(){return ee(n.meta.rid,{payload:n})},0),v===F.initializeEnd&&(i=o(),l=(u=Object.keys(i)).filter(function(e){return b.includes(e)}).map(function(e){return i[e]}),f=[],d=[],g=n.disabled,m=l.map(function(t){var n=t.name;return(function e(t,n,r){return new Promise(function(i,a){return n()?i(t):r<1?a(z({},t,{queue:!0})):new Promise(function(e){return setTimeout(e,10)}).then(function(o){return e(t,n,r-10).then(i,a)})})})(t,t.loaded,1e4).then(function(r){return s[n]||(e.dispatch({type:F.pluginReadyType(n),name:n,events:Object.keys(t).filter(function(e){return!W.includes(e)})}),s[n]=!0),f=f.concat(n),t}).catch(function(e){if(e instanceof Error)throw Error(e);return d=d.concat(e.name),e})}),Promise.all(m).then(function(t){var n={plugins:f,failed:d,disabled:g};setTimeout(function(){u.length===m.length+g.length&&e.dispatch(z({},{type:F.ready},n))},0)}));var $=function(){if(v!==F.bootstrap)return/^ready:([^:]*)$/.test(v)&&setTimeout(function(){var t,n,r,i,u,c,s,l;t=e,n=a,i=o(),c=(u=t.getState()).plugins,s=u.queue,l=u.user,!u.context.offline&&s&&s.actions&&s.actions.length&&(r=s.actions.reduce(function(e,t,n){return c[t.plugin].loaded?(e.process.push(t),e.processIndex.push(n)):(e.requeue.push(t),e.requeueIndex.push(n)),e},{processIndex:[],process:[],requeue:[],requeueIndex:[]})).processIndex&&r.processIndex.length&&(r.processIndex.forEach(function(e){var r,a,e=s.actions[e],o=e.plugin,u=e.payload.type,f=i[o][u];f&&p(f)&&(void 0===(r=e.payload)&&(r={}),void 0===(a=l)&&(a={}),f({payload:e=[X,B].reduce(function(e,t){return r.hasOwnProperty(t)&&a[t]&&a[t]!==r[t]&&(e[t]=a[t]),e},r),config:c[o].config,instance:n}),t.dispatch(z({},e,{type:f=u+":"+o,_:{called:f,from:"queueDrain"}})))}),u=s.actions.filter(function(e,t){return!~r.processIndex.indexOf(t)}),s.actions=u)},0),Promise.resolve(function(e,t,n,r,i){try{var a,o,u,c,s,l,f=p(t)?t():t,d=e.type,g=d.replace(en,"");if(e._&&e._.called)return Promise.resolve(e);var m=n.getState(),h=(c=f,void 0===(s=m.plugins)&&(s={}),void 0===(l=e.options)&&(l={}),Object.keys(c).filter(function(e){var t=l.plugins||{};return y(t[e])?t[e]:!1!==t.all&&(!s[e]||!1!==s[e].enabled)}).map(function(e){return c[e]})),v=(h=d===F.initializeStart&&e.fromEnable?Object.keys(m.plugins).filter(function(t){var n=m.plugins[t];return e.plugins.includes(t)&&!n.initialized}).map(function(e){return f[e]}):h).map(function(e){return e.name}),b=(o=h,u=ec(a=d).map(function(e){return eu(e,o)}),o.reduce(function(e,t){var t=t.name,n=ec(a,t).map(function(e){return eu(e,o)}),r=n[0],i=n[1],n=n[2];return r.length&&(e.beforeNS[t]=r),i.length&&(e.duringNS[t]=i),n.length&&(e.afterNS[t]=n),e},{before:u[0],beforeNS:{},during:u[1],duringNS:{},after:u[2],afterNS:{}}));return Promise.resolve(et({action:e,data:{exact:b.before,namespaced:b.beforeNS},state:m,allPlugins:f,allMatches:b,instance:n,store:r,EVENTS:i})).then(function(e){function t(){var t=function(){if(d.match(en))return Promise.resolve(et({action:z({},a,{type:g+"End"}),data:{exact:b.after,namespaced:b.afterNS},state:m,allPlugins:f,allMatches:b,instance:n,store:r,EVENTS:i})).then(function(e){e.meta&&e.meta.hasCallback&&ee(e.meta.rid,{payload:e})})}();return t&&t.then?t.then(function(){return e}):e}if(el(e,v.length))return e;var a,o=d!==g?Promise.resolve(et({action:z({},e,{type:g}),data:{exact:b.during,namespaced:b.duringNS},state:m,allPlugins:f,allMatches:b,instance:n,store:r,EVENTS:i})).then(function(e){a=e}):void(a=e);return o&&o.then?o.then(t):t()})}catch(I){return Promise.reject(I)}}(n,o,a,e,c)).then(function(e){return e=t(e),r=1,e})}();return Promise.resolve($&&$.then?$.then(h):h($))}catch(S){return Promise.reject(S)}}}}),(w=T,function(e){return function(e){return function(t){var n=t.type,r=t.key,i=t.value,a=t.options;if(n===F.setItem||n===F.removeItem){if(t.abort)return e(t);n===F.setItem?w.setItem(r,i,a):w.removeItem(r,a)}return e(t)}}}),($=(I=ev).storage.setItem,function(e){return function(t){return function(n){var r,i,a,o,u,c,s,l;return n.type===F.bootstrap&&(r=n.params,u=n.user,i=n.persistedUser,a=n.initialUser,o=i.userId===u.userId,i.anonymousId!==u.anonymousId&&$(V,u.anonymousId),o||$(L,u.userId),a.traits&&$(R,z({},o&&i.traits?i.traits:{},a.traits)),(u=Object.keys(n.params)).length&&(c=r.an_uid,s=r.an_event,l=u.reduce(function(e,t){var n;return(t.match(G)||t.match(/^(d|g)clid/))&&(n=t.replace(G,""),e.campaign["campaign"===n?"name":n]=r[t]),t.match(J)&&(e.props[t.replace(J,"")]=r[t]),t.match(K)&&(e.traits[t.replace(K,"")]=r[t]),e},{campaign:{},props:{},traits:{}}),e.dispatch(z({type:F.params,raw:r},l,c?{userId:c}:{})),c&&setTimeout(function(){return I.identify(c,l.traits)},0),s&&setTimeout(function(){return I.track(s,l.props)},0),Object.keys(l.campaign).length&&e.dispatch({type:F.campaign,campaign:l.campaign}))),t(n)}}}),(m=(eh=(eh=ev).storage).setItem,h=eh.removeItem,b=eh.getItem,function(e){return function(t){return function(n){var r,i,a=n.userId,o=n.traits,u=n.options;return n.type===F.reset&&([L,R,V].forEach(function(e){h(e)}),[X,B,"traits"].forEach(function(e){P(Y(e))})),n.type===F.identify&&(b(V)||m(V,x()),r=b(L),i=b(R)||{},r&&r!==a&&e.dispatch({type:F.userIdChanged,old:{userId:r,traits:i},new:{userId:a,traits:o},options:u}),a&&m(L,a),o&&m(R,z({},i,o))),t(n)}}}),ea(ez)]),er={context:e_,user:(d=T,function(e,t){if(void 0===e&&(e={}),(t=void 0===t?{}:t).type===F.setItemEnd){if(t.key===V)return z({},e,{anonymousId:t.value});if(t.key===L)return z({},e,{userId:t.value})}switch(t.type){case F.identify:return Object.assign({},e,{userId:t.userId,traits:z({},e.traits,t.traits)});case F.reset:return[L,V,R].forEach(function(e){d.removeItem(e)}),Object.assign({},e,{userId:null,anonymousId:null,traits:{}});default:return e}}),page:e8,track:eb,plugins:(f=n,function(e,t){void 0===e&&(e={});var n={};if("initialize:aborted"===t.type)return e;if(/^registerPlugin:([^:]*)$/.test(t.type)){var r=em(t.type,"registerPlugin"),i=f()[r];if(!i||!r)return e;var a=t.enabled;return n[r]={enabled:a,initialized:!!a&&Boolean(!i.initialize),loaded:!!a&&Boolean(i.loaded()),config:i.config||{}},z({},e,n)}if(/^initialize:([^:]*)$/.test(t.type))return r=em(t.type,F.initialize),(a=f()[r])&&r?(n[r]=z({},e[r],{initialized:!0,loaded:Boolean(a.loaded())}),z({},e,n)):e;if(/^ready:([^:]*)$/.test(t.type))return n[t.name]=z({},e[t.name],{loaded:!0}),z({},e,n);switch(t.type){case F.disablePlugin:return z({},e,ey(t.plugins,!1,e));case F.enablePlugin:return z({},e,ey(t.plugins,!0,e));default:return e}}),queue:e$},eh=D,ea=D;u&&t.debug&&((T=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__)&&(eh=T({trace:!0,traceLimit:25})),ea=function(){return 0===arguments.length?eN():v(typeof arguments[0])?eP():eP().apply(null,arguments)});var eI,eS,T=Object.keys(eS=t).reduce(function(e,t){return ek.includes(t)||(e[t]=eS[t]),e},{}),t={context:T,user:ep,plugins:A.pluginsArray.reduce(function(e,t){var n=t.name,r=t.config,i=t.loaded,a=A.pluginEnabled[n];return e[n]={enabled:a,initialized:!!a&&Boolean(!t.initialize),loaded:Boolean(i()),config:r||{}},e},{})},ew=function e(t,n,r){if(typeof n===j&&typeof r===M&&(r=n,n=void 0),typeof r!==M){if(typeof r!==j)throw Error("enhancer"+U);return r(e)(t,n)}if(typeof t!==j)throw Error("reducer"+U);var i=t,a=n,o=[],u=o,c=!1;function s(){u===o&&(u=o.slice())}function l(){return a}function f(e){if(typeof e!==j)throw Error("Listener"+U);var t=!0;return s(),u.push(e),function(){var n;t&&(t=!1,s(),n=u.indexOf(e),u.splice(n,1))}}function d(e){if(!v(e))throw Error("Act != obj");if(typeof e.type===M)throw Error("ActType "+M);if(c)throw Error("Dispatch in reducer");try{c=!0,a=i(a,e)}finally{c=!1}for(var t=o=u,n=0;n<t.length;n++)(0,t[n])();return e}return d({type:"@@redux/INIT"}),(r={dispatch:d,subscribe:f,getState:l,replaceReducer:function(e){if(typeof e!==j)throw Error("next reducer"+U);i=e,d({type:"@@redux/INIT"})}})[q]=function(){var e,t=f;return(e={subscribe:function(e){if("object"!=typeof e)throw TypeError("Observer != obj");function n(){e.next&&e.next(a)}return n(),{unsubscribe:t(n)}}})[q]=function(){return this},e},r}(function(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++){var i=t[r];typeof e[i]===j&&(n[i]=e[i])}var a,o,u=Object.keys(n);try{o=n,Object.keys(o).forEach(function(e){var t=o[e];if(typeof t(void 0,{type:"@@redux/INIT"})===M||typeof t(void 0,{type:C})===M)throw Error("reducer "+e+" "+M)})}catch(c){a=c}return function(e,t){if(void 0===e&&(e={}),a)throw a;for(var r,i=!1,o={},c=0;c<u.length;c++){var s,l=u[c],f=e[l],d=(0,n[l])(f,t);if(typeof d===M)throw r=l,Error(s="action "+((s=(s=t)&&s.type)&&s.toString()||"?")+"reducer "+r+" returns "+M);o[l]=d,i=i||d!==f}return i?o:e}}(z({},er,E)),t,ea(eh((function(){var e=arguments;return function(t){return function(n,r,i){var n=t(n,r,i),a=n.dispatch,o={getState:n.getState,dispatch:function(e){return a(e)}},r=[].slice.call(e).map(function(e){return e(o)});return z({},n,{dispatch:a=D.apply(void 0,r)(n.dispatch)})}}}).apply(void 0,ei)))),er=(ew.dispatch=(eI=ew.dispatch,function(e,t,n){return e=z({},e,{meta:eT(e.meta,t,eA(n))}),eI.apply(null,[e])}),Object.keys(Z)),eE=(ew.dispatch({type:F.bootstrap,plugins:er,config:T,params:ef,user:ep,initialUser:_,persistedUser:ed}),er.filter(function(e){return A.pluginEnabled[e]})),ej=er.filter(function(e){return!A.pluginEnabled[e]});return ew.dispatch({type:F.registerPlugins,plugins:er,enabled:A.pluginEnabled}),A.pluginsArray.map(function(e,t){var n=e.bootstrap,r=e.config,i=e.name;n&&p(n)&&n({instance:ev,config:r,payload:e}),ew.dispatch({type:F.registerPluginType(i),name:i,enabled:A.pluginEnabled[i],plugin:e}),A.pluginsArray.length===t+1&&ew.dispatch({type:F.initializeStart,plugins:eE,disabled:ej})}),ev}(n(n({},{storage:eF}),e))}return e.Analytics=eG,e.CONSTANTS=o,e.EVENTS=F,e.default=eG,e.init=eG,Object.defineProperty(e,"__esModule",{value:!0}),e}({});function strail(e={}){return{name:"strail",config:{endpoint:"https://strail-api.herokuapp.com/v2/signals/analytics/"+e.id},initialize({config:e}){},page({payload:e,config:t,instance:n}){let r=n.getState().user.traits,i=n.getState().context,a=JSON.stringify({type:e.type,userId:e.userId,anonymousId:e.anonymousId,properties:e.properties,traits:r,context:i});fetch(t.endpoint,{method:"POST",headers:{"Content-Type":"application/json"},body:a}),console.log(a)},track({payload:e,config:t,instance:n}){let r=n.getState().user.traits,i=n.getState().context,a=JSON.stringify({type:e.type,event:e.event?e.event:"track",userId:e.userId,anonymousId:e.anonymousId,properties:e.properties,traits:r,context:i});fetch(t.endpoint,{method:"POST",headers:{"Content-Type":"application/json"},body:a}),console.log(a)},identify({payload:e,config:t,instance:n}){let r=n.getState().context,i=JSON.stringify({type:e.type,userId:e.userId,anonymousId:e.anonymousId,traits:e.traits,context:r});fetch(t.endpoint,{method:"POST",headers:{"Content-Type":"application/json"},body:i}),console.log(i)}}}